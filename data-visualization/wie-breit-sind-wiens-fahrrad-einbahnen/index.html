<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wie breit sind Wiens Fahrrad-Einbahnen?</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script src="https://unpkg.com/maplibre-gl/dist/maplibre-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/proj4@2.9.2/dist/proj4.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/maplibre-gl/dist/maplibre-gl.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=VT323&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body v-scope="App" @pointermove="drag($event)" @pointerup="stopDragging()">
    <div id="map"></div>
    <div id="crosshair"></div>
    <div
      id="streetview-hint"
      :style="{ left: App.cursorX + 'px', top: App.cursorY + 'px', visibility: App.isHoveringFahrbahnflaeche ? 'visible' : 'hidden' }"
      v-bind:class="{ link: App.isTouchscreen }"
    >
      (Streetview)
    </div>
    <div id="legend">
      <span id="legend-header">Fahrbahnbreite an engster Stelle [m]</span>
      <div id="legend-gradient">
        <div class="mask" :style="{ width: App.lowerThumbOffset + 'px' }"></div>
        <div class="mask" :style="{ width: App.upperThumbOffset + 'px' }"></div>
        <div
          class="thumb"
          :style="{ left: App.lowerThumbOffset + 'px' }"
          @pointerdown="startDragging('lower')"
        >
          <span class="thumb-label" v-if="App.isFiltering || App.dragging"
            >{{App.lowerThumbLabel}}</span
          >
        </div>
        <div
          class="thumb"
          :style="{ right: App.upperThumbOffset + 'px'}"
          @pointerdown="startDragging('upper')"
        >
          <span class="thumb-label" v-if="App.isFiltering || App.dragging"
            >{{App.upperThumbLabel}}</span
          >
        </div>
      </div>
      <div id="legend-labels">
        <span>≤2.5</span>
        <span>3</span>
        <span>3.5</span>
        <span>≥4</span>
      </div>
    </div>
    <div id="infos" v-bind:class="{ visible: App.isInfosPresented }">
      <p>
        Diese Karte visualisiert die Fahrbahnbreite von Einbahnstraßen in Wien
        die nicht für Radfahrende geöffnet sind. Dabei sind nur Einbahnen mit
        Kfz-Tempolimit ≤ 30 km/h berücksichtigt.
      </p>
      <p>
        Die vermessene Fahrbahn umfasst, soweit feststellbar mittels
        <a
          href="https://www.data.gv.at/datasets/7cf0da04-1f77-4321-929e-78172c74aa0b"
          target="_blank"
          >Flächen-Mehrzweckkarte</a
        >, nur befahrbare Flächen und damit keine Parkflächen, Gehsteige,
        Verkehrsinseln etc.
      </p>
      <p>
        Die für Radfahrende nicht geöffneten Einbahnstraßen stammen von der
        <a
          href="https://www.data.gv.at/datasets/3fefc838-791d-4dde-975b-a4131a54e7c5"
          target="_blank"
          >Graphenintegrations-Plattform GIP</a
        >.
      </p>
      <p>Stand der visualisierten Daten: 01.10.2025</p>
      <p>
        <a
          href="https://elias-gander.github.io/2025-10-1-wie-breit-sind-wiens-fahrrad-einbahnen"
          target="_blank"
          >Weitere Informationen</a
        >
        und
        <a
          href="https://github.com/elias-gander/wie-breit-sind-wiens-fahrrad-einbahnen"
          target="_blank"
          >source code</a
        >
      </p>

      <p>
        Straßennamen von &copy;<a
          href="https://openmaptiles.org/"
          target="_blank"
          >OpenMapTiles</a
        >
        und &copy;<a
          href="https://www.openstreetmap.org/copyright"
          target="_blank"
          >OpenStreetMap</a
        >
      </p>
    </div>
    <span id="infos-link" @click="App.isInfosPresented = !App.isInfosPresented"
      >{{ App.isInfosPresented ? 'X' : '?'}}</span
    >

    <div v-if="!App.isReady" id="global-loading-indicator-container">
      <span></span>
    </div>

    <div
      v-bind:class="{ visible: App.isLoadingFahrbahnflaechen }"
      id="fahrbahnflaechen-loading-indicator-container"
    >
      <span id="fahrbahnflaechen-loading-indicator"></span>
      <span id="fahrbahnflaechen-loading-indicator-label"
        >Lade Fahrbahnflächen</span
      >
    </div>

    <script src="scripts/colormaps.js"></script>
    <script type="module" src="scripts/main.js"></script>
  </body>
</html>
